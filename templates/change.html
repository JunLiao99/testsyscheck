<!doctype html>
{% load staticfiles %}
<html lang="us">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
	<title>查詢頁面</title>
	<link href="{% static "js/jquery-ui.css" %}" rel="stylesheet">
	<style>
	body{
		font-family: "Trebuchet MS", sans-serif;
		margin: 50px;
	}
	.demoHeaders {
		margin-top: 2em;
	}
	#dialog-link {
		padding: .4em 1em .4em 20px;
		text-decoration: none;
		position: relative;
	}
	#dialog-link span.ui-icon {
		margin: 0 5px 0 0;
		position: absolute;
		left: .2em;
		top: 50%;
		margin-top: -8px;
	}
	#icons {
		margin: 0;
		padding: 0;
	}
	#icons li {
		margin: 2px;
		position: relative;
		padding: 4px 0;
		cursor: pointer;
		float: left;
		list-style: none;
	}
	#icons span.ui-icon {
		float: left;
		margin: 0 4px;
	}
	.fakewindowcontain .ui-widget-overlay {
		position: absolute;
	}
	select {
		width: 200px;
	}
    </style>
    
    <style>
        a{
            text-decoration: none;
            color:grey;
        }
        a:hover{
            color: red;
        }
        table{
            width: 150%;
            height: 180px;
            border-collapse: collapse;
            padding:10px 5px;
            text-align: center;
            border-color: white;
            font-family:"黑体";
        }
    </style>



</head>
<body>
        {% block twomenu %}
        <div class="container">
                <div class="row">
                <div class="col-sm-1">
                        <button type="button" class="btn btn-outline-dark">查詢</button>
                </div>
                  <div class="col-sm">
                    <p>開始日期：<input type="text" id="datepicker"></p>
                  </div>

                  <div class="col-sm">
                        <p>結束日期：<input type="text" id="datepickerend"></p>
                  </div>

                  <div class="col-sm">
                        <div class="row-6">
                            <H3 style="margin-left:90px">舉發單位: {{leader }} </H3> 
                        </div>
                        <div class="row-sm" style="margin-top:10px">
                            <h2> </h2>
                                <H3 style="margin-left:90px">舉發員警: {{expop}} </H3> 
                        </div>
                        <div class="row-sm"style="margin-top:5px;margin-left:40px">
                            <img src="https://s.yimg.com/uu/api/res/1.2/Fs376FlVZIlxOIonUBfP4w--/YXBwaWQ9eXRhY2h5b247cT03NTs-/http://media.zenfs.com/zh-Hant-TW/homerun/tw.autos.yahoo.com/bf6eb52f0f51f58d18c472db69c9263d" width="300" height="300">
                      </div>
                  </div>
                </div>
              </div>
              {% endblock %}
              <div class="container" style="margin-top:-280px">
                    <div class="row">
                      <div class="col-sm-6">
                            <table border="1px" table id="table01">
                                <tr>
                                    <th>勾選可開單</th>
                                    <th>流水號</th>
                                    <th>車號</th>
                                    <th>車別</th>
                                    <th>7碼違規日期(日)</th>
                                    <th>4碼違規時間(時)</th>
                                    <th>違規地點代碼</th>
                                    <th>違規條款代碼</th>
                                    <th>中文備註</th>
                                    <th>處理狀態</th>
                                    <th>修正動作</th>
                                </tr>
                                <tbody>
                                    {% if messages %}
                                        {% for message in messages %}
                                            <tr class="{% cycle 'active' 'success' 'warning' 'info' %}" id="tr1">
                                                <td><input type="checkbox" value="1" /></td>
                                                <td>{{ message.id }}</td>
                                                <td>{{ message.pltno }}</td>
                                                <td>{{ message.car_tp }}</td>
                                                <td>{{ message.vil_dt }}</td>
                                                <td>{{ message.vil_tm }}</td>
                                                <td>{{ message.vil_add }}</td>
                                                <td>{{ message.rule_1 }}</td>
                                                <!-- <td>{{ message.vildatetime }}</td> -->
                                                <td>{{ message.vilinf }}</td>
                                                <td>{{ message.situa }}</td>
                                                <td><a class="modify"> 修改 </a></td>
                                            </tr>
                                        {% endfor %}
                                    {% else %}
                                        <tr>
                                            <td colspan="4">无数据</td>
                                        </tr>
                                    {% endif %}
                                </tbody>
                            </table>
                            
                            <input class="check" type="button" id="btn" value="檢查" />  
                            <input class="go" type="button" id="btnn" value="送出開單" />  
        <!-- 分页开始 -->
        <nav style="text-align:center;margin-top: 50px">
            {% for page_number in messages.paginator.page_range %}
            {% ifequal page_number posts.number %}
                {{ page_number }}
            {% else %}
                <a  href="?page={{ page_number }}">{{ page_number }}</a>
            {% endifequal %}
            {% endfor %}
        </nav>
        <!-- 分页结束 -->


                    </div>
                  </div>



                  {% block content %}{% endblock %}

    <!-- Datepicker -->




    <script src="{% static "js/jquery.js" %}"></script>
    <script src="{% static "js/jquery-ui.js" %}"></script>






    <script>

    $( "#datepicker" ).datepicker({
        inline: true
    });

    $( "#datepickerend" ).datepicker({
    inline: true
    });


    </script>

    <script type="text/javascript" src="{% static "js/jquery.js" %}"></script>
    
    <script>
		$("th").css({"background-color":"dimgray","color":"white"});
		$("tr:odd").css("background-color","#DCDCDC");
		$("tr:even").css("background-color","whitesmoke");
		
		$(".modify").click(function(){
			$(this).parent().siblings("td:eq(2),td:eq(3),td:eq(4),td:eq(5),td:eq(6),td:eq(7),td:eq(8)").each(function()//找同类元素td
			{
				var is_text = $(this).find("input:text");//判断单元格下是否含有文本框
				if (!is_text.length) {
					$(this).html("<input size='3' type='text' value=' "+$(this).text()+" ' />");
				}
				else
					$(this).html(is_text.val());
			})
		});
		
		// $(".go").click(function(){
		// 	{
        //         var t01 = $("#table01 tr").length;
        //     alert(t01);
        //     $("#table01").find("td").each(function(i) {
        //         var t = $(this).text();
        //         alert(t);
        //     });
		// 	}
		// });
        

        

    </script>
    <script>
            $.ajaxSetup({
            data: { csrfmiddlewaretoken: '{{ csrf_token }}' },
          });
    </script>

    <script>
        $('.check').click( function() {
          var $table = $('#table01');
          var table = $table.tableToJSON(
                      {
                         ignoreColumns:[0,9,10], 
                        //  headings: ['FirstName', 'LastName', 'Score']
                       }); // Convert the table into a javascript object
          console.log(table);
          alert(JSON.stringify(table));

        var data=JSON.stringify(JSON.stringify(table));

        });

    </script>


<script>
        $.ajaxSetup({
            data: { csrfmiddlewaretoken: '{{ csrf_token }}' },
          });
        $('#btnn').click( function() {
            var $table = $('#table01');
            var table = $table.tableToJSON(
                      {
                         ignoreColumns:[0,9,10], 
                        //  headings: ['FirstName', 'LastName', 'Score']
                       }); // Convert the table into a javascript object
            console.log('ss')
            var data1=JSON.stringify(table);
        // 觸發ajax事件
            $.ajax({
                url: "/getq/",
                type: "post",
                dataType : 'json',
                data: {data1,csrfmiddlewaretoken: '{{ csrf_token }}'}
                // success: function (data) {  
                //     console.log('ss');
                // }
            })
    });
    
</script>

    <!-- // $(function(){
    //     $('.go').on('click', function(){
    //         alert('ok')
    //         $.ajax({
    //             url : 'getq/',
    //             method  : 'POST',
    //             dataType : 'json',
    //             async: false,
    //             success : function(data){
    //                 alert('ok')
    //             }
    //         });

    //     });

        // $('.go').click( function() {
        //     var data=JSON.stringify(JSON.stringify(table));
        //     $.ajax({
        //     type:"POST",
        //     url:"getjsonq/",
        //     data:data,
        //     contentType:"application/json", 
        //     success:function(data){
        //         alert('ok')
        //         //显示数据
        //     }
        // });
        // }); -->
        </script>

        

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <script type="text/javascript" src="{% static "js/jquery.tabletojson.js" %}"> </script>
  </body>
</html>